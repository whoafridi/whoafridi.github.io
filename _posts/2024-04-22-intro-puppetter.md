---
layout: post
title: Puppeteer দিয়ে ওয়েব স্ক্র্যাপিং পর্ব ১
subtitle: ওয়েব স্ক্র্যাপিং পর্ব ১
tags: [puppeteer, web scraping, web automation, javascript]
permalink: /puppeteer-introduction/
---

আসসালামুআলাইকুম। আশা করি সবাই ভালো আছেন। আজকে আমি আপনাদের সবার সাথে `Puppeteer` দিয়ে ওয়েব স্ক্র্যাপিং নিয়ে আলোচনা করবো। মূল আলোচনা যাওয়ার আগে আমাদেরকে সর্বপ্রথম জানতে হবে ওয়েব স্ক্র্যাপিং কি? ওয়েব স্ক্র্যাপিং হল একটা ওয়েবসাইট থেকে তথ্য কম্পিউটার প্রোগ্রাম বা সফটওয়্যারের মাধ্যমে সংগ্রহ করা। ধরা যাক, একটা অনলাইন স্টোরের ওয়েবসাইট আছে। আমরা সেই ওয়েবসাইটে গেলে বিভিন্ন পণ্যের তথ্য দেখতে পাই। আমরা যদি চাই, এই ওয়েবসাইটের সবগুলো পণ্যের তথ্য সংগ্রহ করতে, তথন আমাদের বসে বসে ওই ওয়েবসাইটের সবগুলো পেইজে যেতে হবে। তা না করে আমরা একটা সফটওয়্যার লিখতে পারি যে এই কাজটা করে দিবে। অর্থাৎ, ওয়েবসাইটের সবগুলো পেইজ লোড করবে ও পণ্যের তথ্য গুলো সংগ্রহ করে আমাকে দেবে এখন অনেকেই ভাবতে পারেন আজকের পর্বে আমরা অন্যের তথ্যাদি এই জাতীয় যাবতীয় বিষয়াদি দেখাবো কিনা । এখন এই পণ্যের তথ্য সংগ্রহ এবং প্রাইজের বিষয়টি নিয়ে আমরা পরবর্তী পর্বে আলোচনা করব আপাতত আজকের পর্বে আমরা বেসিক বেসিক স্ক্রিপ্ট লিখে কোন প্রকার আউটপুট বের করা যায় কিনা সেসব বিষয়াদি নিয়ে আলোচনায় যাব ।

মুল কার্যক্রম শুরু করার আগে আমাদেরকে কিছু বিষয় সম্পর্কে খেয়াল রাখতে হবে সেই বিষয়গুলো হলো আমরা এখানে ল্যাংগুয়েজ হিসেবে ব্যবহার করব যাব `জাভাস্ক্রিপ্ট` এবং আমাদের স্ক্র্যাপিং করার জন্য ব্যবহার করব `Puppeteer` । এখন আপনার কম্পিউটারে অবশ্যই `Node-Js` (অবশ্যই বর্তমানের এলটিএস ভার্শন ব্যবহার করা প্রয়োজন) ইনস্টল করা থাকতে হবে যার মাধ্যমেই মূলত আমরা এই সকল ধরনের প্রক্রিয়া পরিচালনা করব । `Node-Js` ইনস্টল করা না থাকলে অবশ্যই এই [লিংক](https://nodejs.org/en/download) থেকে গিয়ে আপনার অপারেটিং সিস্টেম অনুযায়ী ইন্সটল করে ফেলতে হবে এবং ইনস্টলেশন কোন প্রবলেম হলে প্রয়োজনীয় ইউটিউব ভিডিও দেখে ফেলতে হবে - এ জাতীয় হাজার রকম ভিডিও ইউটিউবে পাওয়া যায় যে কারণে এই বিষয়ে আর আলোচনায় যাওয়া হলো না । আর কোন কথা নয় এবার আমরা চলে যাবো আমাদের মূল কার্যক্রমে ।

[ বিশেষ দ্রষ্টব্য : এবার আমরা কিছু জিনিস একটু ইংরেজিতে লিখবো যাতে করে জিনিসপত্র বুঝতে সুবিধা হয় এবং অনেক ক্ষেত্রে এ ধরনের জিনিসপত্রের বঙ্গানুবাদ খুব বেশি পছন্দ সই হয় না ]

প্রথমতঃ ইনস্টলেশন এবং সেটাপ দেখব এবং দ্বিতীয়তঃ আমাদের প্রথম স্ক্রিপ্ট রান করব ।

### _ইনস্টলেশন এবং সেটাপ Puppeteer_

আপনাকে অবশ্যই আপনার Puppeteer প্রজেক্ট তৈরি করতে হবে, প্রজেক্ট এর মধ্যে দিয়ে তারপর npm এবং Puppeteer দিয়ে Puppeteer ইনস্টল করতে হবে।

1. কমান্ড লাইন ইন্টারফেস/টার্মিনাল খুলতে হবে

2. আপনার Puppeteer প্রকল্পের জন্য একটি নতুন ডিরেক্টরি তৈরি করুন

> বিশেষ দ্রষ্টব্য : উইন্ডোজের ক্ষেত্রে হয়তো আপনারা কমান্ড লাইন ছাড়াই এ কাজ করতে পারবেন

```bash
mkdir puppeteer-project
```

3. ডিরেক্টরিতে পরিবর্তন করে Puppeteer প্রজেক্ট ডিরেক্টরীতে যেতে হবে

```bash
cd puppeteer-project
```

4. একটি নতুন npm প্রজেক্ট তৈরি করতে নিম্নলিখিত কমান্ডটি চালান

```bash
npm init
```

> এবার সেই মাহেন্দ্রক্ষন

5. নিম্নলিখিত কমান্ড ব্যবহার করে Puppeteer ইনস্টল করুন

```bash
npm install puppeteer
```

ইনস্টল হয়ে গেলে ব্যাস প্রথম ধাপের কাজ শেষ ।

### _প্রথম রান করার পালা_

এখানে আমরা দেখব একটা ব্রাউজার ওপেন করে কিভাবে ব্রাউজারের মধ্যে টুকিটাকি জিনিসপত্র লেখে তার একটা আউটপুট করে বের করা যায়

1. VSCode এর puppeteer প্রজেক্ট ডিরেক্টরি নতুন একটি ফাইল index.js খুলতে হবে

2. ফাইলটিতে নিম্নলিখিত কোডটি কপি করে পেস্ট করতে হবে

```javascript
// import puppetter
import puppeteer from "puppeteer";

(async () => {
  // launch browser
  const browser = await puppeteer.launch({
    headless: false,
    defaultViewport: { width: 810, height: 1080 },
    userDataDir: "temp",
  });
  const page = await browser.newPage();

  const searchTerm = `github`;

  try {
    await page.goto("https://duckduckgo.com/", {
      waitUntil: "networkidle2",
      timeout: 60000,
    });
    await page.type("#searchbox_input", searchTerm);
    await page.click('button[type="submit"]');
    await page.waitForSelector('[data-testid="result-title-a"]');

    const results = await page.evaluate(() => {
      return [
        ...document.querySelectorAll('[data-testid="result-title-a"] span'),
      ].map((a) => a.innerText);
    });

    console.log(results);
  } catch (error) {
    console.error("Error scraping DuckDuckGo:", error);
  } finally {
    await browser.close();
  }
})();
```

4. নিম্নলিখিত কমান্ড লিখে দেখতে হবে আউটপুট কি আসে

```bash
node index.js
```

এই কোডটা আসলে DuckDuckGo তে "github" সার্চ করে এবং সার্চ রেজাল্টগুলোর শিরোনাম কনসোলে আউটপুট দেয়। পুরো প্রক্রিয়াটা একটু ধারাবাহিকভাবে ব্যাখ্যা করি:

1. **`import puppeteer from "puppeteer";`**

   - এখানে `puppeteer` লাইব্রেরি ইনপোর্ট করা হচ্ছে, যার সাহায্যে ব্রাউজার চালানো যাবে এবং ওয়েব পেজের সাথে ইন্টারঅ্যাক্ট করা যাবে।

2. **`(async () => { ... })();`**

   - এখানে একটা অ্যাসিঙ্ক্রোনাস ফাংশন তৈরি করা হয়েছে যাতে আমরা `await` ব্যবহার করতে পারি। এর মানে হলো, যে কাজগুলো আমরা ব্রাউজারে করতে চাই, সেগুলো একে একে সম্পন্ন হবে।

3. **`const browser = await puppeteer.launch({ ... });`**

   - এখানে `puppeteer.launch()` দিয়ে নতুন একটা ব্রাউজার খুলা হচ্ছে। ব্রাউজারটি `headless: false` মানে UI সহ, যেন আমরা দেখতে পারি কী হচ্ছে। পাশাপাশি, কিছু ইউজার ডেটা `userDataDir: "temp"` দিয়ে সেভ করা হচ্ছে।

4. **`const page = await browser.newPage();`**

   - এখানে ব্রাউজারের একটা নতুন পেজ ওপেন করা হচ্ছে। পেজ মানে, যে ওয়েবসাইটটা আমরা স্ক্র্যাপ করব, সেটা এখানে খোলা হবে।

5. **`const searchTerm = 'github';`**

   - স্ক্র্যাপ করতে যে শব্দটা লিখব, সেটা এখানে সেট করা হচ্ছে, যেটা "github"।

6. **`await page.goto("https://duckduckgo.com/", { ... });`**

   - এরপর `page.goto()` দিয়ে DuckDuckGo তে চলে যাওয়া হচ্ছে, যেখানে সার্চ করা হবে। `waitUntil: "networkidle2"` মানে, ওয়েব পেজটি সম্পূর্ণভাবে লোড হওয়া পর্যন্ত অপেক্ষা করা হবে।

7. **`await page.type("#searchbox_input", searchTerm);`**

   - DuckDuckGo’র সার্চ বক্সে "github" শব্দটি টাইপ করা হচ্ছে।

8. **`await page.click('button[type="submit"]');`**

   - এরপর সার্চ বাটনে ক্লিক করা হচ্ছে, যাতে সার্চ প্রক্রিয়া শুরু হয়।

9. **`await page.waitForSelector('[data-testid="result-title-a"]');`**

   - সার্চ রেজাল্ট আসা পর্যন্ত অপেক্ষা করা হচ্ছে। এটি নিশ্চিত করবে যে ফলাফলগুলো লোড হয়েছে।

10. **`const results = await page.evaluate(() => { ... });`**

    - এখানে `page.evaluate()` ব্যবহার করে পেজের DOM থেকে রেজাল্টের শিরোনাম সংগ্রহ করা হচ্ছে। সার্চ রেজাল্টের লিংকগুলোর ভেতরের টেক্সট আমরা `span` থেকে বের করছি।

11. **`console.log(results);`**

    - তারপর স্ক্র্যাপ করা রেজাল্টগুলো কনসোলে প্রিন্ট করা হচ্ছে, যাতে আমরা দেখতে পারি কী কী রেজাল্ট পাওয়া গেছে।

12. **`} catch (error) { console.error("Error scraping DuckDuckGo:", error); }`**

    - যদি কিছু ভুল হয় বা কোনো এরর আসে, তাহলে সেটা কনসোলে দেখানো হবে।

13. **`finally { await browser.close(); }`**
    - সবকিছু শেষ হয়ে গেলে ব্রাউজারটা বন্ধ হয়ে যাবে। এটা নিশ্চিত করার জন্য যে ব্রাউজারটি খোলা না থাকে।

এই কোডের পুরো উদ্দেশ্য হলো DuckDuckGo তে "github" সার্চ করা এবং তারপর প্রাপ্ত শিরোনামগুলো স্ক্র্যাপ করা। এরপর, ওই রেজাল্টগুলো কনসোলে প্রিন্ট করা। পরবর্তী পর্বে আমরা ই-কমার্স এর প্রোডাক্ট এর প্রাইস, নাম বের করা নিয়ে আলোচনা করব । আপাতত এ পর্যন্তই কোন প্রশ্ন থাকলে আমাকে [ফেসবুকে](https://facebook.com/whoafridi) যোগাযোগ করতে পারেন ।
